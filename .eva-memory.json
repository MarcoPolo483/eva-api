{
  "$schema": "https://marcopolo483.github.io/eva-suite/schemas/eva-memory-v1.json",
  "version": "1.0.0",
  "repo": {
    "name": "eva-api",
    "pod": "POD-F",
    "purpose": "API gateway and routing layer for EVA Suite. REST + GraphQL + Webhooks. FastAPI with Azure AD authentication. Reference: OpenWebUI + PubSec Info Assistant patterns.",
    "status": "active",
    "owner": "P04-LIB + P15-DVM",
    "dependencies": [
      "eva-orchestrator (specification)",
      "eva-core (business logic)",
      "eva-auth (authentication)"
    ],
    "lastUpdated": "2025-12-07T21:40:00Z" // 2025-12-07 16:40:00 EST
  },
  "context": {
    "summary": "Phase 2.x, 3, and 4 COMPLETE! Azure services fully integrated (Cosmos DB, Blob Storage, Azure OpenAI with RAG), GraphQL API operational with queries/mutations/subscriptions, SDK generation scripts ready (Python, TypeScript, .NET). Test suite: 98 tests (100% passing), 62.71% coverage. All Azure services have graceful fallback modes. Ready for integration testing with actual Azure credentials.",
    "keyFiles": [
      "docs/SPECIFICATION.md",
      "ACTION-PLAN.md",
      "docs/PHASE-2X-3-4-COMPLETION.md",
      "docs/TESTING-STATUS.md",
      ".eva-housekeeping.json",
      ".eva-memory.json",
      "src/eva_api/main.py",
      "src/eva_api/routers/spaces.py",
      "src/eva_api/routers/documents.py",
      "src/eva_api/routers/queries.py",
      "src/eva_api/services/cosmos_service.py",
      "src/eva_api/services/blob_service.py",
      "src/eva_api/services/query_service.py",
      "src/eva_api/graphql/schema.py",
      "src/eva_api/graphql/resolvers.py",
      "src/eva_api/graphql/router.py",
      "scripts/generate-sdks.ps1",
      "sdks/README.md",
      "tests/"
    ],
    "currentPhase": "Phases 1-4 Complete - Ready for Phase 5: Developer Portal or Integration Testing",
    "openIssues": 0,
    "blockers": []
  },
  "quality": {
    "testCoverage": 62.71,
    "lintWarnings": 0,
    "typeScriptStrict": false,
    "wcagCompliance": "WCAG 2.2 AA (developer portal)",
    "bilingualStatus": "EN-CA/FR-CA (API errors + docs)"
  },
  "memory": {
    "lessons": [
      "Always install production dependencies (requirements.txt) before running tests - editable install only sets up package structure",
      "Coverage dropped from 82% to 62.71% after adding Azure integrations - expected since they require actual credentials for full testing",
      "FastAPI test client + fixture pattern enables fast, comprehensive unit testing without running full server",
      "Multi-stage Docker builds reduce image size significantly (builder stage for compilation, runtime stage for execution)",
      "FastAPI dependency_overrides in conftest.py allows easy mocking of authentication for tests without complex setup",
      "Strawberry GraphQL @enum decorator requires Python Enum subclass - cannot use plain class",
      "httpx 0.28+ breaks Starlette TestClient compatibility - pin to 0.26.0 for stable tests",
      "Graceful fallback pattern crucial for Azure services - enables development without credentials",
      "asyncio.create_task for fire-and-forget background processing in query service"
    ],
    "tools": [
      "pytest + pytest-cov + pytest-asyncio: Comprehensive testing with async support and coverage reporting",
      "ruff + mypy + black: Fast, modern Python linting and type checking",
      "FastAPI TestClient: Enables synchronous testing of async endpoints (requires httpx==0.26.0)",
      "Strawberry GraphQL: Modern GraphQL for Python with excellent FastAPI integration",
      "Azure SDKs: azure-cosmos 4.5.1, azure-storage-blob 12.19.0, openai 1.12.0 (Azure OpenAI)",
      "Docker Compose: Local development environment with Redis for rate limiting",
      "SDK Generators: openapi-python-client, openapi-generator-cli, NSwag"
    ],
    "patterns": [
      "OpenWebUI modular router pattern: Separate routers for /health, /auth, /api/v1/*, /graphql routes",
      "PubSec Info Assistant Azure integration: Cosmos DB (metadata), Blob Storage (files), Azure OpenAI (RAG queries)",
      "Dependency injection for testability: Settings, auth verification, service classes injected via FastAPI Depends()",
      "Graceful degradation: All Azure services check for credentials and fall back to placeholder mode",
      "RAG pattern: Retrieve documents from space → build context → Azure OpenAI with system/user prompts → store result",
      "GraphQL context pattern: Build context with services + user info from JWT for every request",
      "Cursor-based pagination: Stateless pagination using continuation tokens from Cosmos DB",
      "Async job pattern for queries: Submit returns 202 Accepted, poll status, retrieve result when complete",
      "Fire-and-forget with asyncio.create_task: Background query processing without blocking API response"
    ]
  },
  "reports": {
    "lastHousekeeping": null,
    "lastAudit": null,
    "lastTestRun": "2025-12-07T21:40:00Z", // 2025-12-07 16:40:00 EST
    "lastTestResults": {
      "totalTests": 98,
      "passed": 98,
      "failed": 0,
      "coverage": "62.71%",
      "duration": "1746.14s"
    },
    "cachePath": ".eva-cache/"
  },
  "bootstrap": {
    "readOnOpen": true,
    "autoUpdate": "nightly",
    "backupEnabled": true,
    "backupPath": ".eva-cache/backups/"
  },
  "_metadata": {
    "createdBy": "TASK-002 Bootstrap Memory Template",
    "createdAt": "2025-11-29T00:00:00Z",
    "templateVersion": "1.0.0",
    "lastModifiedBy": "Phase 2 Implementation Complete - GitHub Copilot",
    "lastModifiedAt": "2025-12-07T16:18:00Z"
  }
}
